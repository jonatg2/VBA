Attribute VB_Name = "OutlookOpenTest"
Option Explicit

Sub TestOutlookIsOpen()
Dim oOutlook As Object
Dim OutlookPaths(0 To 5) As Variant
Dim path As Variant

OutlookPaths(0) = "C:\Program Files\Microsoft Office 2016\64\OUTLOOK.exe"
OutlookPaths(1) = "C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.exe"

    On Error Resume Next
    Set oOutlook = GetObject(, "Outlook.Application")
    On Error GoTo 0

    If oOutlook Is Nothing Then
        For Each path In OutlookPaths
            If Dir(path) <> "" Then
                Shell Replace(path, ".exe", ""), vbNormalFocus
                Exit For
            End If
        Next path
    End If
End Sub



